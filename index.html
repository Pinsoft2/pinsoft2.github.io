<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Previous head content remains same until styles -->
    <style>
        /* Previous styles remain the same except for these updates */
        
        /* Updated snowflakes position */
        .snowfall-left, .snowfall-right {
            position: fixed;
            top: -100px;
            width: 900px;
            height: 900px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.8;
        }

        .snowfall-left {
            left: -200px; /* Moved closer to tree */
        }

        .snowfall-right {
            right: -200px; /* Moved closer to tree */
        }

        /* Updated Toothless positions */
        .toothless-left, .toothless-right {
            position: fixed;
            bottom: 150px; /* Lowered position */
            width: 400px;
            height: 400px;
        }

        /* Complete blackout for login overlay */
        #loginOverlay {
            background: rgba(0, 0, 0, 0.95); /* Darker background */
            backdrop-filter: blur(8px); /* Added blur effect */
        }

        /* Rest of the styles remain same */
    </style>
</head>
<body>
    <!-- Previous snowfall and toothless elements remain same -->

    <div class="container">
        <div id="loginOverlay">
            <div class="login-box">
                <h2>See you, space</h2>
                <!-- Rest of login box content remains same -->
            </div>
        </div>

        <!-- Rest of container content remains same -->
    </div>

    <script>
        // Previous code remains same until createCalendar function

        function createCalendar() {
            const calendar = document.getElementById('calendar');
            const configs = JSON.parse(localStorage.getItem('calendarConfig') || '{}');
            
            // Create array of numbers 1-19 for randomization
            let numbers = Array.from({length: 19}, (_, i) => i + 1);
            // Shuffle numbers
            for (let i = numbers.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
            }
            
            const layout = [1, 3, 4, 5, 6];
            let boxIndex = 0;

            layout.forEach(boxCount => {
                const row = document.createElement('div');
                row.className = 'tree-row';
                
                for (let i = 0; i < boxCount && boxIndex < 19; i++) {
                    const box = createBox(numbers[boxIndex], configs[boxIndex + 1]);
                    row.appendChild(box);
                    boxIndex++;
                }
                
                calendar.appendChild(row);
            });

            // Create trunk
            const trunkRow = document.createElement('div');
            trunkRow.className = 'tree-row';
            const trunk = createTrunk(configs[20]);
            trunkRow.appendChild(trunk);
            calendar.appendChild(trunkRow);
        }

        function createBox(number, config) {
            const box = document.createElement('div');
            box.className = 'calendar-box';
            
            // Add gift emoji or configured image
            if (config && config.image) {
                const img = document.createElement('img');
                img.src = config.image;
                img.className = 'box-image';
                box.appendChild(img);
            } else {
                const gift = document.createElement('div');
                gift.className = 'gift-emoji';
                gift.textContent = 'ðŸŽ';
                box.appendChild(gift);
            }
            
            // Add hidden number
            const numberDiv = document.createElement('div');
            numberDiv.className = 'number';
            numberDiv.textContent = number;
            box.appendChild(numberDiv);
            
            box.onclick = () => handleBoxClick(box);
            return box;
        }

        function handleBoxClick(element) {
            if (!element.classList.contains('opened')) {
                element.classList.add('opened');
                createSparkles(element);
                
                // Hide gift/image and show number
                const gift = element.querySelector('.gift-emoji');
                const image = element.querySelector('.box-image');
                const number = element.querySelector('.number');
                
                if (gift) gift.style.display = 'none';
                if (image) image.style.display = 'none';
                if (number) setTimeout(() => number.style.opacity = '1', 300);
            }
        }

        // Rest of the code remains same
    </script>
</body>
</html>
